version: "2"
services:
  hubot-rocketchat:
    image: cusdeb/hubot-rocketchat:1.0.11-amd64
    network_mode: "host"
    environment:
    - ROCKETCHAT_URL=${ROCKETCHAT_URL}
    - ROCKETCHAT_ROOM=${ROCKETCHAT_ROOM}
    - ROCKETCHAT_USER=${ROCKETCHAT_USER}
    - ROCKETCHAT_PASSWORD=${ROCKETCHAT_PASSWORD}
    - EXTERNAL_SCRIPTS=${EXTERNAL_SCRIPTS}
    - HUBOT_NAME=${HUBOT_NAME}
    - LISTEN_ON_ALL_PUBLIC=${LISTEN_ON_ALL_PUBLIC}
    - TZ=${TZ}
    # hubot-auth
    - HUBOT_AUTH_ADMIN=${HUBOT_AUTH_ADMIN}
    # hubot-happy-birthder
    - TENOR_API_KEY=${TENOR_API_KEY}
    - TENOR_IMG_LIMIT=${TENOR_IMG_LIMIT}
    - TENOR_SEARCH_TERM=${TENOR_SEARCH_TERM}
    - BIRTHDAY_CRON_STRING=${BIRTHDAY_CRON_STRING}
    - ANNOUNCER_CRON_STRING=${ANNOUNCER_CRON_STRING}
    - BIRTHDAY_ANNOUNCEMENT_BEFORE_CNT=${BIRTHDAY_ANNOUNCEMENT_BEFORE_CNT}
    - BIRTHDAY_ANNOUNCEMENT_BEFORE_MODE=${BIRTHDAY_ANNOUNCEMENT_BEFORE_MODE}
    # hubot-redis-brain
    - REDIS_URL=${REDIS_URL}
    volumes:
    - ./scripts:/home/hubot/scripts
  redis:
    image: cusdeb/redis:5.0-amd64
    network_mode: "host"
    environment:
    - REDIS_CONF_bind=127.0.0.1
    - REDIS_CONF_port=16379
    # Enable AOF
    - REDIS_CONF_appendonly=yes
    # Disable RDB
    - REDIS_CONF_save=
    - REDIS_CONF_loglevel=notice
    volumes:
    - /srv/redis-dump:/dump

